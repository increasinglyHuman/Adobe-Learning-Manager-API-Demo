<!DOCTYPE html>
<html>
<head>
    <title>ALM OAuth Callback</title>
    <style>
        body {
            font-family: monospace;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        .code-block {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 5px;
            word-break: break-all;
        }
        .instructions {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>ALM OAuth Callback Handler</h1>
    
    <div id="content">
        <p>Received OAuth callback...</p>
    </div>

    <script>
        // Parse URL parameters
        const params = new URLSearchParams(window.location.search);
        const code = params.get('code');
        const primeBase = params.get('PRIME_BASE');
        
        const content = document.getElementById('content');
        
        if (code) {
            content.innerHTML = `
                <h2>✅ Authorization Code Received!</h2>
                
                <div class="code-block">
                    <strong>Code:</strong> ${code}<br>
                    <strong>Prime Base:</strong> ${primeBase || 'Not provided'}
                </div>
                
                <div class="instructions">
                    <h3>Next Steps:</h3>
                    <p>To exchange this code for an access token, make a POST request to:</p>
                    <code>${primeBase || 'https://learningmanager.adobe.com'}/oauth/token</code>
                    
                    <p>With these parameters:</p>
                    <ul>
                        <li>grant_type: "authorization_code"</li>
                        <li>code: "${code}"</li>
                        <li>client_id: (your client ID)</li>
                        <li>client_secret: (your client secret)</li>
                        <li>redirect_uri: "https://p0qp0q.com/alm-quiz/callback"</li>
                    </ul>
                    
                    <p>You can test it with curl:</p>
                    <div class="code-block">
curl -X POST "${primeBase || 'https://learningmanager.adobe.com'}/oauth/token" \\
  -H "Content-Type: application/x-www-form-urlencoded" \\
  -d "grant_type=authorization_code" \\
  -d "code=${code}" \\
  -d "client_id=YOUR_CLIENT_ID" \\
  -d "client_secret=YOUR_CLIENT_SECRET" \\
  -d "redirect_uri=https://p0qp0q.com/alm-quiz/callback"
                    </div>
                </div>
                
                <p><strong>Note:</strong> Authorization codes expire quickly (usually in 10 minutes), so exchange it soon!</p>
            `;
        } else {
            content.innerHTML = `
                <h2>❌ No Authorization Code</h2>
                <p>No authorization code was found in the URL.</p>
                <p>URL: ${window.location.href}</p>
            `;
        }
    </script>
</body>
</html>